"0","getPoisson<-function(){"
"0","  a=-1"
"0","  while(a<0 | a>4){"
"0","    a=rpois(1, 1)"
"0","  }"
"0","  return(a)"
"0","}"
"0","getClonotype<-function(){"
"0","  numberA=getPoisson()"
"0","  numberB=getPoisson()"
"0","  result=DataFrame()"
"0","  indexInPool=sample.int(poolSize, 1, replace=TRUE)"
"0","  if (numberA>=1){"
"0","    result=rbind(result,samplePool[[indexInPool]][1,])"
"0","    numberA=numberA-1"
"0","  }"
"0","  if (numberB>=1){"
"0","    result=rbind(result,samplePool[[indexInPool]][2,])"
"0","    numberB=numberB-1"
"0","  }"
"0","  while(numberA>0 | numberB>0){"
"0","    indexInPool=sample.int(poolSize, 1, replace=TRUE)"
"0","    if (numberA>=1){"
"0","      result=rbind(result,samplePool[[indexInPool]][1,])"
"0","      numberA=numberA-1"
"0","    }"
"0","    else{"
"0","      result=rbind(result,samplePool[[indexInPool]][2,])"
"0","      numberB=numberB-1"
"0","    }"
"0","  }"
"0","  if(length(result$barcode)){"
"0","    for(i in 1:length(result$barcode)){"
"0","      result$barcode[i]=result$barcode[1]"
"0","      result$sample[i]='sim'"
"0","    }"
"0","  }"
"0","  return(result)"
"0",""
"0","}"
